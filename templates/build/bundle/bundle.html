{% extends 'base-derk.html' %}
{% load static %}

{% block title_block %} Bundle {% endblock %}

{% block main_header_block %}
<br>
<div class="row">
   <div>
      <!-- Change to Other One if Preferred -->
      <!-- Bundle View: <p>{{ bundle.name }}</p> -->
      Bundle View: {{ bundle.name }}
   </div>
   <hr>
</div>
{% endblock %}

{% block about_header_block %}
<div class="row center">
   <br>
   
   
   
   <!-- Help Button -->
   <div class="col-md-2">
      <button class="btn btn-teal" data-toggle="bundle-collapse" href="#content" role="button"> What is a bundle? </button>
   </div>
   
   <!-- Delete Button -->
   <!-- See if we can make this into a pop-up modal instead of having a separate delete pages -->
   <div class="col-md-3">
      <a href="{% url 'build:bundle_delete' bundle.pk %}">
         <button role="button" class="btn btn-red"> Delete {{ bundle }} Bundle </button>
      </a>
   </div>

   <!-- View XML Files Button -->
   <div class="col-md-3">
      <a href="{% url 'build:directory_view' bundle.relative_dir %}">
         <button role="button" class="btn btn-blue"> View {{ bundle }} Directory </button>
      </a>
   </div>
   
   <!-- Download Button -->
   <div class="col-md-4">
      <a href="{% url 'build:bundle_download' bundle.pk %}   ">
         <button role="button" width="500 px" class="btn btn-cyan" data-toggle="tiptool" data-placement="right"
         title="Click this button to download a zip file of the current bundle template package as it currently is. The resulting package will contain all label templates you've included in your bundle and may or may not be complete depending on how much tailoring you've done throughout the system.">
         Download {{ bundle }} Bundle Template Package 
      </button>
   </a>
</div>

   <!-- IDK where this section is in the bundle page never seen it before -->
   <div id="content" class="bundle-collapse">
      <div class="col align self end">
         <div class="card card-body">
            <strong>Bundles:</strong>
            <br>
            A bundle is the default logical construct for archiving digital data in the PDS. Bundles have a simple
            hierarchical structure. A bundle has one or more member collections, each of which has one or more member
            basic products. PDS does not impose requirements on how bundles are defined except that (1) bundles must be
            distinct with unique identifiers within the overall holdings of PDS, and (2) each bundle must be approved by
            a PDS peer review.
            <br>
            <strong>Archive structure:</strong>
            <br>
            Members of a bundle are listed in a Product_Bundle, an XML file which serves as a label and collection
            listing. Product_Bundle is described and uniquely identified using the Product_Bundle class definition.
            <br>
         </div>
      </div>
   </div>

   <br>
</div>
{% endblock %}

{% block body_block %}
<div class="container-fluid pt-3">
   <!-- Info Card -->
   <div class="row justify-content-center align-items-center">
      <div class="col-md-12">
         <div class="card d-flex p-2">
            <h2 class="card-title text-center mt-3"> <strong>{{ bundle.name }} </strong> </h2>
            <p class="card-body text-left z-depth-2">
               <!-- LID -->
               <strong>LID:</strong> {{ bundle.lid }}
               <br>
   
               <!-- Status -->
               <strong>Status:</strong>
               {% if bundle.status == 'b' %} Build <br>
               {% elif bundle.status == 'r' %} Review <br>
               {% else %} Submit <br>
               {% endif %}
   
               <!-- Creator -->
               <strong>Creator:</strong> {{bundle.user}}<br>
               
               <br>
               Below are several sections that ELSA needs you to fill out to make your templates as complete as possible.
               Several sections are used universally throughout your bundle (e.g., Investigation Area and Context). The
               Collections section will allow you to add, view, and edit collections that you would like to include in your
               bundle.
   
               <div class="col p-1 m-3 mt-0 text-center">
                     <!--'Help' is removed as it does not serve any required functionality -->
                     {% comment %} <a type="button" class="btn btn-info text-light" href="" aria-expanded="true" style="box-shadow: none;">Help</a> {% endcomment %}
                     <a type="button" class="btn btn-danger text-light" data-bs-toggle="modal" data-bs-target="#delete_modal" aria-expanded="false" style="box-shadow: none;">Delete Bundle</a>
                     <a type="button" class="btn btn-success text-light" href="{% url 'build:bundle_download' bundle.pk %}" aria-expanded="false" style="box-shadow: none;">Download Bundle</a>
                     
                     <a type="button" class="btn btn-light text-light dropdown-toggle" id="investigation_dropdown" data-bs-toggle="dropdown" aria-expanded="false" style="box-shadow: none;">Edit Investigation Area</a>
                        <ul class="dropdown-menu" aria-labelledby="investigation_dropdown">
                           <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#alias_modal">Alias</a></li>
                           <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#mod_history_modal">Modification History</a></li>
                           <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#citation_information_modal">Citation Information</a></li>
                        </ul>
                     
                     <a type="button" class="btn btn-light text-light" data-bs-toggle="modal" data-bs-target="#context_modal" aria-expanded="false" style="box-shadow: none;">Edit Context Products</a>
                     <a type="button" class="btn btn-light text-light" data-bs-toggle="modal" data-bs-target="#collections_modal" aria-expanded="false" style="box-shadow: none;">Edit Collections</a>
               </div>
            </p>
         </div>
      </div>
   </div>

   <!-- The Rest -->
<div class="row py-4">
  <div class="col-md-3">
    <!-- Files Card -->
    <div class="card d-flex mb-4">
       <h5 class="card-header bg-secondary text-light text-center">Files</h5>
      <div class="card_body m-4">
        <div class="col">
          {% for f in file_context %}
          <div class="col py-2">                  
            <button 
              type="button" 
              class="btn btn-light text-white file-button text-center" 
              data-filename="{{ f.0 }}" 
              data-content="{{ f.1 }}"
              {% if forloop.first %} id="defaultFile" {% endif %}>
              {{ f.0 }}
            </button>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>

   <div class="card">
   <h5 class="card-header bg-secondary text-white text-center">Bundle Progress</h5>
   <div class="list-group list-group-flush">
      <!-- Alias -->
      <div class="list-group-item d-flex justify-content-between align-items-center">
         Alias
         <span class="badge {% if status_dict.Alias %}bg-success{% else %}bg-danger{% endif %}">
            {% if status_dict.Alias %}
               <i class="bi bi-check-circle-fill"></i>
            {% else %}
               <i class="bi bi-x-circle-fill"></i>
            {% endif %}
         </span>
      </div>
      <!-- Modification History -->
      <div class="list-group-item d-flex justify-content-between align-items-center">
         Modification History
         <span class="badge {% if status_dict.Modification_History %}bg-success{% else %}bg-danger{% endif %}">
            {% if status_dict.Modification_History %}
               <i class="bi bi-check-circle-fill"></i>
            {% else %}
               <i class="bi bi-x-circle-fill"></i>
            {% endif %}
         </span>
      </div>
      <!-- Citation Information -->
      <div class="list-group-item d-flex justify-content-between align-items-center">
         Citation Information
         <span class="badge {% if status_dict.Citation_Information %}bg-success{% else %}bg-danger{% endif %}">
            {% if status_dict.Citation_Information %}
               <i class="bi bi-check-circle-fill"></i>
            {% else %}
               <i class="bi bi-x-circle-fill"></i>
            {% endif %}
         </span>
      </div>
      <!-- Investigations -->
      <div class="list-group-item d-flex justify-content-between align-items-center">
         Investigations
         <span class="badge {% if status_dict.Investigations %}bg-success{% else %}bg-danger{% endif %}">
            {% if status_dict.Investigations %}
               <i class="bi bi-check-circle-fill"></i>
            {% else %}
               <i class="bi bi-x-circle-fill"></i>
            {% endif %}
         </span>
      </div>
      <!-- Hosts -->
      <div class="list-group-item d-flex justify-content-between align-items-center">
         Hosts
         <span class="badge {% if status_dict.Hosts %}bg-success{% else %}bg-danger{% endif %}">
            {% if status_dict.Hosts %}
               <i class="bi bi-check-circle-fill"></i>
            {% else %}
               <i class="bi bi-x-circle-fill"></i>
            {% endif %}
         </span>
      </div>

      <!-- Instruments -->
      <div class="list-group-item d-flex justify-content-between align-items-center">
         Instruments
         <span class="badge {% if status_dict.Instruments %}bg-success{% else %}bg-danger{% endif %}">
            {% if status_dict.Instruments %}
               <i class="bi bi-check-circle-fill"></i>
            {% else %}
               <i class="bi bi-x-circle-fill"></i>
            {% endif %}
         </span>
      </div>

      <!-- Targets -->
      <div class="list-group-item d-flex justify-content-between align-items-center">
         Targets
         <span class="badge {% if status_dict.Targets %}bg-success{% else %}bg-danger{% endif %}">
            {% if status_dict.Targets %}
               <i class="bi bi-check-circle-fill"></i>
            {% else %}
               <i class="bi bi-x-circle-fill"></i>
            {% endif %}
         </span>
      </div>
   </div>
</div>
</div>



   <div class="col-md-9">
      <div class="card d-flex">
         <h2 class="card-title text-center mt-3" id="fileName">File Content</h2>
         <div class="card-body m-3 mt-1">
            <pre><code id="fileContent"></code></pre>
         </div>
      </div>
   </div>

   <!-- Only works here, idk why it doesnt work when moved to elsa.js - deric -->
   <script>
      const showFileContent = function(filename, content) {
         document.getElementById('fileName').textContent = filename;
         document.getElementById('fileContent').textContent = content;
      };

      
      window.onload = function() {
         const defaultFileButton = document.getElementById('defaultFile');
         if (defaultFileButton) {
            const filename = defaultFileButton.getAttribute('data-filename');
            const content = defaultFileButton.getAttribute('data-content'); 
            showFileContent(filename, content); 
         }
      };

      
      document.querySelectorAll('.file-button').forEach(button => {
         button.addEventListener('click', function() {
            const filename = this.getAttribute('data-filename');
            const content = this.getAttribute('data-content');
            showFileContent(filename, content);
         });
      });
   </script>
</div>

<!-- Form Modals -->
<!-- Figure out how to move these to new file for readability sake - deric -->

<!-- Delete Bundle Modal -->
<div class="modal fade" id="delete_modal" tabindex="-1" aria-hidden="true">
   <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
         <!-- Title -->
         <div class="modal-header">
            <h3 class="modal-title w-100 text-center">Delete Bundle</h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
         </div>

         <!-- Modal Body -->
         <div class="modal-body">
            <div class="text-center">
               <h5>Are you sure you want to delete <i>"{{ bundle }}"</i>?</h5>
               <p class="text-muted">
                  <i>Caution: This bundle will be deleted immediately and this action cannot be undone.</i>
               </p>

               <div class="container">
                  <div class="row">
                     <div class="col-12 col-md-6 mb-2">
                        <button type="button" class="btn btn-secondary w-100" data-bs-dismiss="modal">
                           Cancel
                        </button>
                     </div>
                     <div class="col-12 col-md-6 mb-2">
                        <a href="{% url 'build:bundle_delete' bundle.pk %}" class="btn btn-danger w-100">
                           Confirm Delete
                        </a>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>

{% if context_successful_submit %}
    <script type="text/javascript">
        $(document).ready(function(){
            $("#context_modal").modal('show');
        });
    </script>
{% endif %}

{% if additional_collection_successful_submit %}
    <script type="text/javascript">
        $(document).ready(function(){
            $("#collections_modal").modal('show');
        });
    </script>
{% endif %}

<!-- Context Modal -->
<div class="modal fade" id="context_modal">
   <div class="modal-dialog modal-xl">
      <div class="modal-content">
         <!-- Title -->
         <div class="modal-header d-flex justify-content-center position-relative">
            <h5 class="modal-title">Context</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="position: absolute; right: 1.5rem;"></button>
         </div>

         <div class="modal-body">
            <!-- Tabs -->
            <ul class="nav nav-fill nav-underline nav-justified" role="tablist">
               
               <!-- If the bundle type is external, we don't need to show the investigation tab -Rupak -->
               {% if bundle_type != "External" %} 
               <li class="nav-item" role="presentation">
                  <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#con_inv" type="button" role="tab" aria-selected="true">Investigation</button>
               </li>
               {% endif %}

               {% if instrument_hosts %}
               <li class="nav-item" role="presentation">
                  <button class="nav-link " data-bs-toggle="tab" data-bs-target="#con_ih" type="button" role="tab" aria-selected="false">Instrument Hosts</button>
               </li>
               {% endif %}
               {% if instruments %}
               <li class="nav-item" role="presentation">
                  <button class="nav-link " data-bs-toggle="tab" data-bs-target="#con_ins" type="button" role="tab" aria-selected="false">Instruments</button>
               </li>
               {% endif %}
               <li class="nav-item" role="presentation">
                  <button class="nav-link " data-bs-toggle="tab" data-bs-target="#con_tar" type="button" role="tab" aria-selected="false">Targets</button>
               </li>
            </ul>

            <!-- Content -->

            {% if bundle_type != "External" %} 
            <div class="tab-content">
               <!-- Investigation Tab -->
                <!-- Contact Modal -->
               <div class="modal fade" id="contactModal" tabindex="-1" role="dialog" aria-labelledby="contactModalLabel" aria-hidden="true">
                  <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
                     <div class="modal-content">
                           <form method="post" action="{% url 'main:context_products_contact' %}">
                              {% csrf_token %}
                              <input type="hidden" name="form_name" value="contact_form">

                              <div class="modal-header">
                                 <h5 class="modal-title" id="contactModalLabel">Send a Message to ELSA</h5>
                                 <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                              </div>

                              <div class="modal-body">
                                 <p>Please describe the context product you need. An ATM node representative will contact you to finalize what you need before officially submitting to the PDS system.</p>
                                 {% for field in context_products_contact %}
                                       <div class="form-group">
                                          {{ field.label_tag }} 
                                          {{ field }}
                                          {% if field.errors %}
                                             <div class="text-danger">{{ field.errors }}</div>
                                          {% endif %}
                                       </div>
                                 {% endfor %}
                              </div>

                              <style>
                                 .contact_submit {
                                    display: inline-flex;
                                    align-items: center; 
                                    justify-content: center; 
                                    color: white;
                                    padding: 2x 2px;
                                    background-color: #2bbbad;
                                    border-radius: 5px;
                                    text-decoration: none; 
                                    cursor: pointer;
                                    transition: background-color 0.3s;
                                 }
                              </style>

                              <div class="modal-footer">
                                 <button type="submit" class="contact_submit">Send message</button>
                              </div>
                           </form>
                     </div>
                  </div>
               </div>
               <div class="tab-pane fade show active" id="con_inv" role="tabpanel" >
                  <br>
                  <div class="col-md-12">
                     <div class="card">
                     <div class="card-header">
                        <p> To begin, select an investigation product below to associate with your bundle. Investigations serve as the top level of the context system and will associate your bundle with a larger project.</br> <strong>Investigations are categorized as:</strong> Individual Investigations, Missions, Field Campaigns, Observing Campaigns, or Other Investigations. Selecting an investigation will pare down the list of components to the ones that go with that investigation (i.e., associated instruments, targets, etc.) </p>
                     </div>
                     <form class="card-body black-text text-left z-depth-2" id="form_investigation" method="post" action="{% url 'build:bundle' bundle.pk  %}">
                        {% csrf_token %}
                        <input type="hidden" name="form_name" value="investigation_form">
                        <input type="hidden" name="form_name" value="contact_form">
                        {% for field in form_investigation %}
                           <div class="form-group">
                                 {{ field.label_tag }}
                                 {{ field }}
                                 {% if field.errors %}
                                 <div class="text-danger">{{ field.errors }}</div>
                                 {% endif %}
                           </div>
                        {% endfor %}
                        <!-- <input type="hidden" name="form_name" value="investigation_form"> -->

                        <div class="d-flex">
                           <input type="submit" class="btn btn-light text-light mt-4" value="Submit"/>
                           <input type="button" class="btn btn-light text-light mt-4 ms-auto" data-bs-toggle="modal" data-bs-target="#contactModal" value="Contact">
                        </div>
                     </form>
                  </br>
                  </div>
               </div>

            <br>

                  {% if investigations %}
                     {% for investigation in investigations %}
                        <div class="container mt-2">
                           <div class="card">
                              <div class="row no-gutters">
                                 <div class="col-md-2">
                                    <img class="img-fluid" src="{% static 'images/investigation.png' %}" alt="Investigation Image" style="max-width: 65%;">
                                 </div>
                                 <div class="col-md-8">
                                    <div class="card-body">
                                       <h5 class="card-title">{{ investigation }}</h5>
                                       <p class="card-text">{{ investigation.lid }}</p>

                                       {% if investigation in instrument_host_investigations %}
                                          {% for instrument_host in instrument_hosts %}
                                             {% if instrument_host.investigations.last == investigation %}
                                                <a type="button" class="btn btn-light text-light" href="{% url 'build:context_search_instrument' bundle.pk investigation.pk instrument_host.pk %}">Add Instrument</a>
                                             {% endif %}
                                          {% endfor %}
                                          <a type="button" class="btn btn-light text-light" href="{% url 'build:context_search_target_investigation' bundle.pk investigation.pk %}">Add Target</a>
                                       {% else %}
                                          <a type="button" class="btn btn-light text-light" href="{% url 'build:context_search_instrument_host_and_facility' bundle.pk investigation.pk %}">Add Host</a>
                                       {% endif %}


                                       <a type="button" class="btn btn-danger" href="{% url 'build:delete_investigation' bundle.pk investigation.pk %}">Remove</a>

                                 <!-- <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p> -->
                                    </div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     {% endfor %}
                  {% else %}
                  {% endif %}
               </div>
               <!-- Instrument Hosts -->
               <div class="tab-pane fade" id="con_ih" role="tabpanel">
                  <br>

                  <div class="col-md-12">
                     <div class="card">
                     <div class="card-header">
                        <p>Here you can view the Instrument Hosts tied to the current Bundle.</p>
                     </div> 
                     </br>
                     </div>
                  </div>

                  <br>

                  {% if instrument_hosts %}
                     {% for instrument_host in instrument_hosts %}
                     <div class="container mt-3">
                        <div class="card">
                           <div class="row no-gutters">
                              <div class="col-md-2">
                                 <img class="img-fluid" src="{% static 'images/host.png' %}" alt="Target Image" style="max-width: 65%;">
                              </div>
                              <div class="col-md-8">
                                 <div class="card-body">
                                    <h5 class="card-title">{{ instrument_host }}</h5>
                                    <p class="card-text">Investigation(s): {{ instrument_host.investigations.last }}</p>
                                    <p class="card-text">{{ instrument_host.lid }}</p>
                                    <a type="button" class="btn btn-danger" href="{% url 'build:delete_instrument_host' bundle.pk instrument_host.pk %}">Remove</a>

                                <!-- <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p> -->
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                     {% endfor %}
                  {% else %}
                  <div class="container mt-2">
                     <div class="sub-card card">
                        <div class="row no-gutters">
                           <div class="col-md-2">
                              <img class="img-fluid" src="{% static 'images/null.png' %}" alt="Null" style="max-width: 65%;">
                           </div>
                           <div class="col-md-8">
                              <div class="card-body">
                                 <h4 class="card-title">No Instrument Hosts</h5>
                                 <!-- <p class="card-text">Add a Instrument Host</p> -->
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
                  {% endif %}
               </div>
               <!-- Instruments -->
               <div class="tab-pane fade" id="con_ins" role="tabpanel">
                  <br>

                  <div class="col-md-12">
                     <div class="card">
                     <div class="card-header">
                        <p>Here you can view the Instrument Hosts tied to the current Bundle.</p>
                     </div> 
                     </br>
                     </div>
                  </div>

                  <br>

                  {% if instruments %}
                     {% for instrument in instruments %}
                     <div class="container mt-3">
                        <div class="card">
                           <div class="row no-gutters">
                              <div class="col-md-2">
                                 <img class="img-fluid" src="{% static 'images/host.png' %}" alt="Target Image" style="max-width: 65%;">
                              </div>
                              <div class="col-md-8">
                                 <div class="card-body">
                                    <h5 class="card-title">{{ instrument }}</h5>
                                    <p class="card-text">{{ instrument.lid }}</p>
                                    <a type="button" class="btn btn-danger" href="{% url 'build:delete_instrument' bundle.pk instrument.pk %}">Remove</a>

                                <!-- <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p> -->
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                     {% endfor %}
                  {% else %}
                  <div class="container mt-2">
                     <div class="sub-card card">
                        <div class="row no-gutters">
                           <div class="col-md-2">
                              <img class="img-fluid" src="{% static 'images/null.png' %}" alt="Null" style="max-width: 65%;">
                           </div>
                           <div class="col-md-8">
                              <div class="card-body">
                                 <h4 class="card-title">No Instruments</h5>
                                 <!-- <p class="card-text">Add a Instrument Host</p> -->
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
                  {% endif %}
               </div>

               <!-- Other Products -->
               <div class="tab-pane fade" id="con_tar" role="tabpanel">
                  <br>

                  <div class="col-md-12">
                     <div class="card">
                     <div class="card-header">
                        <p>Choose the target(s) you wish to add to your bundle. This is a complete list of availabe targets, independent of any investigations chosen.</p>
                     </div>
                     <form class="card-header black-text text-left z-depth-2"id="query01" method="post" action="{% url 'build:context_search_target' bundle.pk %}">
                        
                        {% csrf_token %}
                        {{ form_target }}
                        {{ form.errors }}
                        {{ form.non_field_errors }}
                        
                     <div class="d-flex">
                        <input type="submit" class="btn btn-light text-light mt-4" value="Submit"/>
                        <input type="button" class="btn btn-light text-light mt-4 ms-auto" data-bs-toggle="modal" data-bs-target="#contactModal" value="Contact">
                     </div>
                             
                     </form>                  
                     </br>
                     </div>
                  </div>

                  <br>

                  {% if targets %}
                     {% for target in targets %}
                     <div class="container mt-3">
                        <div class="card">
                           <div class="row no-gutters">
                              <div class="col-md-2">
                                 <img class="img-fluid" src="{% static 'images/target.png' %}" alt="Target Image" style="max-width: 65%;">
                              </div>
                              <div class="col-md-8">
                                 <div class="card-body">
                                    <h5 class="card-title">{{ target }}</h5>
                                    <p class="card-text">Investigation(s):
                                       {% for investigation in target.investigations.all %} 
                                       <span>
                                          {{ investigation.name }}
                                       </span>
                                       {% endfor %}
                                    </p>
                                    <p class="card-text">{{ target.lid }}</p>
                                    <a type="button" class="btn btn-danger" href="{% url 'build:delete_target' bundle.pk target.pk %}">Remove</a>

                                <!-- <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p> -->
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                     {% endfor %}
                  {% else %}
                  <div class="container mt-2">
                     <div class="sub-card card">
                        <div class="row no-gutters">
                           <div class="col-md-2">
                              <img class="img-fluid" src="{% static 'images/null.png' %}" alt="Null" style="max-width: 65%;">
                           </div>
                           <div class="col-md-8">
                              <div class="card-body">
                                 <h4 class="card-title">No Targets</h5>
                                 <!-- <p class="card-text">Add a Instrument Host</p> -->
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
                  {% endif %}
               </div>   
            </div>
            <!-- End of Investigation and Targets Tab for all other than External -->
            
            {% else %}
            <div class="tab-content">
               <div class="tab-pane fade show active" id="con_tar" role="tabpanel">
                  <br>

                  <div class="col-md-12">
                     <div class="card">
                     <div class="card-header">
                        <p>Choose the target(s) you wish to add to your bundle. This is a complete list of availabe targets, independent of any investigations chosen.</p>
                     </div>
                     <form class="card-header black-text text-left z-depth-2"id="query01" method="post" action="{% url 'build:context_search_target' bundle.pk %}">
                        
                             {% csrf_token %}
                             {{ form_target }}
                             {{ form.errors }}
                             {{ form.non_field_errors }}
                             
                             <input type="submit" class="btn btn-light text-light" value="Submit"/>
                             
                         </form>  
                     </br>
                     </div>
                  </div>

                  <br>

                  {% if targets %}
                     {% for target in targets %}
                     <div class="container mt-3">
                        <div class="card">
                           <div class="row no-gutters">
                              <div class="col-md-2">
                                 <img class="img-fluid" src="{% static 'images/target.png' %}" alt="Target Image" style="max-width: 65%;">
                              </div>
                              <div class="col-md-8">
                                 <div class="card-body">
                                    <h5 class="card-title">{{ target }}</h5>
                                    <p class="card-text">Investigation(s):
                                       {% for investigation in target.investigations.all %} 
                                       <span>
                                          {{ investigation.name }}
                                       </span>
                                       {% endfor %}
                                    </p>
                                    <p class="card-text">{{ target.lid }}</p>
                                    <a type="button" class="btn btn-danger" href="{% url 'build:delete_target' bundle.pk target.pk %}">Remove</a>

                                <!-- <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p> -->
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                     {% endfor %}
                  {% else %}
                  <div class="container mt-2">
                     <div class="sub-card card">
                        <div class="row no-gutters">
                           <div class="col-md-2">
                              <img class="img-fluid" src="{% static 'images/null.png' %}" alt="Null" style="max-width: 65%;">
                           </div>
                           <div class="col-md-8">
                              <div class="card-body">
                                 <h4 class="card-title">No Targets</h5>
                                 <!-- <p class="card-text">Add a Instrument Host</p> -->
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
                  {% endif %}
               </div>   
            </div>
            {% endif %}

         </div>
      </div>
   </div>
</div>

<!-- Investigation Area Modal -->
<!-- Splitting the Investigation Area into 3 different pop-up modals accessed by the dropdown -->

<!-- Alias -->
<div class="modal fade" id="alias_modal">
   <div class="modal-dialog modal-xl">
      <div class="modal-content">
         <!-- Title -->
         <div class="modal-header d-flex justify-content-center position-relative">
            <h5 class="modal-title">Alias</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="position: absolute; right: 1rem;"></button>
         </div>

         <div class="modal-body pt-0">

            <!-- Content -->
            <div class="tab-content">
               <!-- Alias -->
               <div class="tab-pane show active" id="inv_alias" role="tabpanel">
                  <!-- Form -->
                  <div class="row px-2">
                     <form action="{% url 'build:bundle' bundle.pk %}" method="post" id="form_alias" >
                        {% csrf_token %}

                        <!-- Alternate ID -->
                        <div class="mt-3">
                           <label for="alt_id">Alternate ID<span class="text-danger" title="This field is required">*</span></label>
                           {{ form_alias.alternate_id }}
                        </div>

                        <!-- Alternate Title -->
                        <div class="mt-3">
                           <label for="alt_title">Alternate Title<span class="text-danger" title="This field is required">*</span></label>
                           {{ form_alias.alternate_title }}
                        </div>

                        <!-- Comment -->
                        <div class="mt-3">
                           <label for="comment">Comment</label>
                           {{ form_alias.comment }}
                        </div>
                        
                        <!-- Create Alias -->
                        <button type="submit" class="btn btn-light text-light my-4">Create Alias</button>
                     </form>
                  </div>

                  <!-- List of Aliases -->
                  <div class="modal-footer justify-content-start">
                     <!-- No Aliases Exist -->
                     {% if alias_set_count == 0 %}
                        <p>No Aliases Found</p>
                     
                     <!-- Display Aliases -->
                     {% else %}
                        {% for alias in alias_set %}
                        <a href="{% url 'build:alias_edit' bundle.pk alias.pk %}" style="text-decoration: none;" data-toggle="tiptool" data-placement="right" title="Click me to edit this Alias Form">
                        </a>

                        <div class="card snippet-card ms-0 me-3">
                           <div class="card-body">
                              <h5 class="card-title">{{ alias.alternate_title }}</h5>
                              <h6 class="card-subtitle text-muted mb-2">Alternate ID: {{ alias.alternate_id }}</h6>
                              <p class="card-text">{{ alias.comment }}</p>
                              <a href="{% url 'build:alias_edit' bundle.pk alias.pk %}" class="btn btn-light text-light d-flex justify-content-center">Edit</a>
                           </div>
                        </div>
                        {% endfor %}
                     {% endif %}
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>

<!-- Modificaiton History -->
<div class="modal fade" id="mod_history_modal">
   <div class="modal-dialog modal-xl">
      <div class="modal-content">
         <!-- Title -->
         <div class="modal-header d-flex justify-content-center position-relative">
            <h5 class="modal-title">Modification History</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="position: absolute; right: 1rem;"></button>
         </div>

         <div class="modal-body pt-0">

            <!-- Content -->
            <div class="tab-content">

               <!-- Modification History -->
               <div class="tab-pane show active" id="inv_mod" role="tabpanel">
                  <div class="row px-2">
                     <form action="{% url 'build:bundle' bundle.pk %}" method="post" id="form_modification_history">
                        {% csrf_token %}

                        <!-- Version ID -->
                        <div class="mt-3">
                           <label for="version_id">Version ID<span class="text-danger" title="This field is required">*</span></label>
                           {{ form_modification_history.version_id }}
                        </div>

                        <!-- Description-->
                        <div class="mt-3">
                           <label for="mod_desc">Description</label>
                           {{ form_modification_history.description }}
                        </div>

                        <!-- Modification Date -->
                        <div class="mt-3">
                           <label for="mod_date">Modificaiton Date<span class="text-danger" title="This field is required">*</span></label>
                           {{ form_modification_history.modification_date }}
                        </div>
                        
                        <!-- Create Modification History -->
                        <button type="submit" class="btn btn-light text-light my-4">Create Modification History</button>
                     </form>
                  </div>

                  <!-- List of Modification History Snippets -->
                  <div class="modal-footer justify-content-start">
                     <!-- No Modificaiton History Snippets Exist -->
                     {% if modification_history_set_count == 0 %}
                        <p>No Modification History Found</p>
                     
                     <!-- Display Modification History Snippets -->
                     {% else %}
                     {% for modification_history in modification_history_set %}
                     <div class="card snippet-card ms-0 me-3">
                        <div class="card-body">
                           <p class="card-text">Version ID: {{ modification_history.version_id}}</p>
                           <p class="card-text">Description: {{ modification_history.description }}</p>
                           <p class="card-text">Modification Date: {{ modification_history.modification_date }}</p>
                        
                           <form action="{% url 'build:modification_history_delete' bundle.pk modification_history.pk %}" method="post" style="display:inline;">
                              {% csrf_token %}
                              <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                          </form>
                        
                        </div>
                     </div>
                     {% endfor %}
                     {% endif %}
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>


<!-- Citation Information -->
<div class="modal fade" id="citation_information_modal">
   <div class="modal-dialog modal-xl">
      <div class="modal-content">
         <!-- Title -->
         <div class="modal-header d-flex justify-content-center position-relative">
            <h5 class="modal-title">Citation Information</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="position: absolute; right: 1rem;"></button>
         </div>

         <div class="modal-body pt-0">

            <!-- Content -->
            <div class="tab-content">
               <!-- Citation Information -->
               <div class="tab-pane show active" id="inv_cite" role="tabpanel">
                  <!-- Form -->

               {% if citation_information_set_count == 0 %}
                  <div class="row px-2">
                     <!-- This is where to change the linkage to one of the new pages -->
                     <!--Changed the view after build and added citation information.pk-->
                     <form action="{% url 'build:bundle' bundle.pk %}" method="post" id="form_citation_information"> 
                        {% csrf_token %}
                        
                        <!-- Author List -->
                        <div class="mt-3">
                           <label for="author_list">Number of Authors (People)</label>
                           {{ form_citation_information.number_of_authors_people }}
                        </div>

                        <div class="mt-3">
                           <label for="author_list">Number of Authors (Organizations)</label>
                           {{ form_citation_information.number_of_authors_organization }}
                        </div>

                        <!-- Editor List -->
                        <div class="mt-3">
                           <label for="author_list">Number of Editors (People)</label>
                           {{ form_citation_information.number_of_editors_people }}
                        </div>

                        <div class="mt-3">
                           <label for="author_list">Number of Editors (Organizations)</label>
                           {{ form_citation_information.number_of_editors_organization }}
                        </div>

                        <!-- Keyword -->
                        <div class="mt-3">
                           <label for="keyword">Keyword</label>
                           {{ form_citation_information.keyword }}
                        </div>

                        <!-- Publication Year -->
                        <div class="mt-3">
                           <label for="publication_year">Publication Year<span class="text-danger" title="This field is required">*</span></label>
                           {{ form_citation_information.publication_year }}
                        </div>

                        <!-- Description -->
                        <div class="mt-3">
                           <label for="mod_desc">Description<span class="text-danger" title="This field is required">*</span></label>
                           {{ form_citation_information.description }}
                        </div>

                        {{ form_citation_information.errors }}

                        <!-- Create Citation Information -->
                        <button type="submit" class="btn btn-light text-light my-4">Create Citaiton Information</button>
                     </form>
                  </div>
                  
                  {% else %}

                  <div class="row px-2">
                     <!--This logic needs to be changed: When exists, it displays list author and list editor as carousel-->
                     <!--For now, it is displaying the same thing as when nothing exists; which is the main form to add citation information-->
                     <form action="{% url 'build:bundle' bundle.pk %}" method="post" id="form_citation_information"> 
                        {% csrf_token %}
                        
                        <!-- Author List -->
                        <div class="mt-3">
                           <label for="author_list">Number of Authors (People)</label>
                           {{ form_citation_information.number_of_authors_people }}
                        </div>

                        <div class="mt-3">
                           <label for="author_list">Number of Authors (Organizations)</label>
                           {{ form_citation_information.number_of_authors_organization }}
                        </div>

                        <!-- Editor List -->
                        <div class="mt-3">
                           <label for="author_list">Number of Editors (People)</label>
                           {{ form_citation_information.number_of_editors_people }}
                        </div>

                        <div class="mt-3">
                           <label for="author_list">Number of Editors (Organizations)</label>
                           {{ form_citation_information.number_of_editors_organization }}
                        </div>

                        <!-- Keyword -->
                        <div class="mt-3">
                           <label for="keyword">Keyword</label>
                           {{ form_citation_information.keyword }}
                        </div>

                        <!-- Publication Year -->
                        <div class="mt-3">
                           <label for="publication_year">Publication Year<span class="text-danger" title="This field is required">*</span></label>
                           {{ form_citation_information.publication_year }}
                        </div>

                        <!-- Description -->
                        <div class="mt-3">
                           <label for="mod_desc">Description<span class="text-danger" title="This field is required">*</span></label>
                           {{ form_citation_information.description }}
                        </div>

                        {{ form_citation_information.errors }}

                        <!-- Create Citation Information -->
                        <button type="submit" class="btn btn-light text-light my-4">Create Citaiton Information</button>
                     </form>
                  </div>


                  {% endif %}
                  

                  <!-- List of Citation Information Snippets -->
                  <div class="modal-footer justify-content-start">
                     <!-- No Citation Information Snippets Exist -->
                     {% if citation_information_set_count == 0 %}
                        <p>No Citation Information Found</p>
                     
                     <!-- Display Citation Information Snippets -->
                     {% else %}
                        {% for citation_information in citation_information_set %}
                        <div class="card snippet-card ms-0 me-3">
                           <div class="card-body">
                              <p class="card-text">Author List: {{ citation_information.author_list }}</p>
                              <p class="card-text">Editor List: {{ citation_information.editor_list }}</p>
                              <p class="card-text">Keyword(s): {{ citation_information.editor_list }}</p>
                              <p class="card-text">Publication Year: {{ citation_information.publication_year }}</p>
                              <p class="card-text">Description: {{ citation_information.description }}</p>

                              <!-- The edit does not work yet. Prompting the user to delete the citaion info to make changes. -->
                              {% comment %} <form action="" method="post" style="display:inline;">
                                 {% csrf_token %}
                                 <button type="submit" class="btn btn-light btn-sm">Edit</button>
                              </form> {% endcomment %}

                              <button type="button" class="btn btn-light btn-sm"
                                    onclick="alert('Edit functionality is currently under development.\nPlease delete and create a new citation to make any changes.\nWe apologize for the inconvenience!')">
                                 Edit
                              </button>
                           
                              <!--implementing citation delete-->
                              <form action="{% url 'build:citation_information_delete' bundle.pk citation_information.pk %}" method="post" style="display:inline;">
                                 {% csrf_token %}
                                 <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                              </form>
                           </div>
                        </div>
                        {% endfor %}

                     {% endif %}
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>

<!-- Collections Modal -->
<div class="modal fade" id="collections_modal">
   <div class="modal-dialog modal-xl">
      <div class="modal-content">
         <!-- Title -->
         <div class="modal-header d-flex justify-content-center position-relative">
            <h5 class="modal-title">Collections Area</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="position: absolute; right: 1.5rem;"></button>
         </div>

         <div class="modal-body ">
            <!-- Tabs -->
            <ul class="nav nav-fill nav-underline nav-justified" role="tablist">
               <li class="nav-item" role="presentation">
                  <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#doc_collection" type="button" role="tab" aria-selected="true">Document Collection</button>
               </li>

               {% for add_collection in additional_collections_set %}
               <li class="nav-item" role="presentation">
                  <button class="nav-link" data-bs-toggle="tab" data-bs-target="#additional_{{ add_collection.collection_name }}_collection" type="button" role="tab" aria-selected="false">{{ add_collection.collection_name }}</button>
               </li>
               {% endfor %}
               
               <li class="nav-item" role="presentation">
                  <button class="nav-link" data-bs-toggle="tab" data-bs-target="#add_a_collection" type="button" role="tab" aria-selected="false"><i class="fa fa-plus me-2"></i> Add New Collection</button>
               </li>
            </ul>

            <!-- Content -->
            <div class="tab-content">
               <!-- Document Collection -->
               <div class="tab-pane fade show active" id="doc_collection" role="tabpanel">
                  <br>
                  <div class="col-md-12">
                     <div class="card">
                     <div class="card-header">
                        <p> This is your document collection. In this collection, you should plan to put any documentation you 
                           think users of your data might need to understand and use your data. Typically users would expect to 
                           find a user guide and/or supporting documentation in this collection. Helpful movies, graphics, or 
                           other non-standard archive formats could also be here if they helpful for documenting your bundle.</p>
                     </div>
                     <button type="button" class="btn btn-light text-light" data-bs-toggle="modal" data-bs-target="#document_modal">Add Document Products</button>
                     </div>
                  </div>

                  <!-- List of Product Documents -->
                  <div class="modal-footer justify-content-start">
                     {% if documents %}
                        {% for document in documents %}
                        <div class="card snippet-card ms-0 me-3">
                           <div class="card-body">
                              <h5 class="card-title">{{ document.document_name }}</h5>
                              <p class="card-text">Acknowledgment list: {{ document.acknowledgement_text }}</p>
                              <p class="card-text">Author list: {{ document.author_list }}</p>
                              <p class="card-text">Copyright: {{ document.copyright }}</p>
                              <p class="card-text">Description: {{ document.description }}</p>
                              <p class="card-text">Document editions: {{ document.document_editions }}</p>
                              <p class="card-text">DOI: {{ document.doi }}</p>
                              <p class="card-text">Editor list {{ document.editor_list }}</p>
                              <p class="card-text">Publication date: {{ document.publication_date }}</p>
                              <p class="card-text">revision ID: {{ document.revision_id }}</p>
                              <a href="{%  url 'build:product_document' bundle.pk document.pk %}" class="btn btn-light text-light d-flex justify-content-center">Edit</a>
                           </div>
                        </div>
                        {% endfor%}
                     {% else %}
                     <p>No Documents Found</p>
                     {% endif %}
                  </div>
               </div>


               <!-- Additional Collections -->
               {% for add_collection in additional_collections_set %}
               <div class="tab-pane fade" id="additional_{{ add_collection.collection_name }}_collection" role="tabpanel">
                  <br>
                  <div class="col-md-12">
                     <div class="card">
                     <div class="card-header">
                        <p> This is a data collection. In this collection, you will build labels for data products. Data products are also 
                           known as Product_Observational and include things like tables of data, image files, etc. Currently ELSA 
                           will help you build tempaltes for data tables. Types of tables ELSA knows how to label are:
                           
                           <ul>
                              <li>Table Binary</li>
                              <li>Table Character</li>
                              <li>Table Delimited</li>

                        </p>
                     </div>
                     <button type="button" class="btn btn-light text-light" data-bs-toggle="modal" data-bs-target="#data_product_modal">Add Data Products</button>
                     </div>
                  </div>

                  <!-- List of Collections -->
                  <div class="modal-footer justify-content-start">
                     {% for data in data_set %}
                     {% if data.collection == add_collection %}
                        {% if data.collection == add_collection %}
                     <div class="card snippet-card ms-0 me-3">
                        <div class="card-body">
                           <h5 class="card-title">{{ data.name }}</h5>
                           <p class="card-text">Processing Level: {{ data.processing_level }}</p>
                           <p class="card-text">Data Type: {{ data.data_type }}</p>
                           <a href="{%  url 'build:table_creation' bundle.pk data.pk %}" class="btn btn-light text-light d-flex justify-content-center">Edit</a>
                        </div>
                     </div>
                     {% endif %}
                        {% endif %}
                     {% endfor %}
                  </div>
               </div>
               {% endfor %}

               <!-- Add s Collections -->
               <div class="tab-pane fade" id="add_a_collection" role="tabpanel">
                  <!-- Form -->
                  <div class="row px-2">
                     <form action="{% url 'build:bundle' bundle.pk %}" method="post" id="form_collections" >
                        {% csrf_token %}

                        <!-- Collection Name -->
                        <div class="mt-3">
                           <label for="col_name">Collection Name<span class="text-danger" title="This field is required">*</span></label>
                           {{ form_additional_collections.collection_name }}
                        </div>

                        <!-- Alternate Title -->
                        <div class="mt-3">
                           <label for="col_type">Collection Type<span class="text-danger" title="This field is required">*</span></label>
                           {{ form_additional_collections.collection_type }}
                        </div>

                        <!-- Create Collection -->
                        <button type="submit" class="btn btn-light text-light my-4">Create Collection</button>
                     </form>
                  </div>

                  <!-- List of Collections -->
                  <div class="modal-footer justify-content-start">
                     {% if additional_collections_count != 0 %}
                        {% for additional_collection in additional_collections_set %}
                           {% for collection in additional_collection.collections_list %}
                           <div class="card snippet-card ms-0 me-3">
                              <div class="card-body">
                                 <h5 class="card-title">{{ collection.0}} Collection</h5>
                                 {% if collection.1 == 'Data' %}
                                 <h6 class="card-subtitle">In here is where you will be able to add your data products that belong to this collection. You may choose from different processing levels for each data product.</h6>
                                 <a href="" class="btn btn-light text-light d-flex justify-content-center">Add DATA</a>
                                 {% endif %}
                              </div>
                           </div>
                           {% endfor %}
                        {% endfor %}
                     {% else %}
                        <p>No Collections Found</p>
                     {% endif %}
                  </div>
               </div>

            </div>

         </div>
      </div>
   </div>

   <!-- Document Product Modal -->
   <div class="modal fade" id="document_modal">
      <div class="modal-dialog modal-xl">
         <div class="modal-content">
            <!-- Title -->
            <div class="modal-header">
               <h5 class="modal-title">Add Document Product</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div class="modal-body pt-0">
               <div class="row px-2">
                  <form action="{% url 'build:bundle' bundle.pk %}" method="post" id="form_document">
                     {% csrf_token %}

                     <!-- Name-->
                     <div class="mt-3">
                        <label for="doc_name">Document Name</label>
                        {{ form_document.document_name }}
                     </div>

                     <!-- Publication Date -->
                     <div class="mt-3">
                        <label for="pub_date">Publication Date</label>
                        {{ form_document.publication_date }}
                     </div>

                     <!-- Author List -->
                     <div class="mt-3">
                        <label for="auth_list">Author List</label>
                        {{ form_document.author_list }}
                     </div>

                     <!-- Copyright-->
                     <div class="mt-3">
                        <label for="copyright">Copyright</label>
                        {{ form_document.copyright }}
                     </div>

                     <!-- Description -->
                     <div class="mt-3">
                        <label for="description">Description</label>
                        {{ form_document.description }}
                     </div>

                     <!-- Revision ID-->
                     <div class="mt-3">
                        <label for="rev_id">Revision ID</label>
                        {{ form_document.revision_id }}
                     </div>
                     
                     <!-- document_editions -->
                     <div class="mt-3">
                        <label for="doc_editions">Document Editions</label>
                        {{ form_document.document_editions }}
                     </div>
                     
                     <!-- edition name -->
                     <div class="mt-3">
                        <label for="edition_name">Edition Name</label>
                        {{ form_document.edition_name }}
                     </div>

                     <!-- Language -->
                     <div class="mt-3">
                        <label for="language">Language</label>
                        {{ form_document.language }}
                     </div>

                     <!-- Files-->
                     <div class="mt-3">
                        <label for="files">Files</label>
                        {{ form_document.files }}
                     </div>

                     <!-- file_name -->
                     <div class="mt-3">
                        <label for="file_name">File Name</label>
                        {{ form_document.file_name }}
                     </div>

                     <!-- Local ID -->
                     <div class="mt-3">
                        <label for="local_id">Local ID</label>
                        {{ form_document.local_id }}
                     </div>
                     
                     <!-- Document SSTD ID -->
                     <div class="mt-3">
                        <label for="doc_std_id">Document STD ID</label>
                        {{ form_document.document_std_id }}
                     </div>

                     <!-- Create Product Document -->
                     <button type="submit" class="btn btn-light text-light my-4">Create Document</button>
                  </form>
               </div>
            </div>
         </div>
      </div>
   </div>

   <!-- Data Product Modal -->
   <div class="modal fade" id="data_product_modal">
      <div class="modal-dialog modal-xl">
         <div class="modal-content">
            <!-- Title -->
            <div class="modal-header">
               <h5 class="modal-title">Add Data Product</h5>
               <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div class="modal-body pt-0">
               <div class="row px-2">
                  <form action="{% url 'build:bundle' bundle.pk %}" method="post" id="form_data">
                     {% csrf_token %}

                     <!-- Name-->
                     <div class="mt-3">
                        <label for="data_name">Name<span class="text-danger" title="This field is required">*</span></label>
                        {{ form_data.name }}
                     </div>

                     <!-- Processing Level -->
                     <div class="mt-3">
                        <label for="processing_level">Processing Level</label>
                        {{ form_data.processing_level }}
                     </div>

                     <!-- Data Type -->
                     <div class="mt-3">
                        <label for="data_type">Data Type</label>
                        {{ form_data.data_type }}
                     </div>

                     <!-- <script>
                        document.addEventListener("DOMContentLoaded", function () {
                            var dropdown = document.getElementById("id_data_type");
                            var checkboxContainer = document.getElementById("header_field");
                            var checkbox = document.getElementById("id_header");
                
                            function toggleCheckboxVisibility() {
                                if (dropdown.value === "Table Delimited") {  // Adjust to match the triggering option
                                    checkboxContainer.style.display = "block";
                                } else {
                                    checkboxContainer.style.display = "none";
                                    checkbox.checked = false;  // Uncheck when hidden
                                }
                            }
                
                            dropdown.addEventListener("change", toggleCheckboxVisibility);
                            toggleCheckboxVisibility(); // Call on page load to ensure correct state
                        });
                    </script> -->

                    <style>
                        #checkbox-container {
                           display: none;
                        }
                    </style>

                     <!-- Data Type Header -->
                     <div id="header_field" class="mt-3">
                        <label for="header">Header?</label>
                        {{ form_data.header }}
                     </div>

                     <!-- Collection -->
                     <div class="mt-3">
                        <label for="collection">Collection<span class="text-danger" title="This field is required">*</span></label>
                        {{ form_data.collection }}
                     </div>

                     <!-- Create Product Document -->
                     <button type="submit" class="btn btn-light text-light my-4">Add Data</button>
                  </form>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>
{% endblock %}